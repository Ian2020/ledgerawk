#!/bin/env bash
#
# Usage: $0 [institution] FILE
#
# Available institutions:
#   santander
#   usbank
# 
# FILE should be the copied transactions from your bank.

# TODO: Check institution supplied is valid
TMP="$(mktemp -d -t)/"
echo "Results will be in $TMP"
./reader_"${1}" "$2" > "$TMP${1}2.txt" &&
sort -gr < "$TMP${1}2.txt" > "$TMP${1}3.txt" &&
./ledgerimport "$TMP/${1}3.txt" > "$TMP${1}4.txt" &&
./postings.sh "$TMP/${1}4.txt" > "$TMP${1}5.txt"
$EDITOR "$TMP${1}5.txt"
